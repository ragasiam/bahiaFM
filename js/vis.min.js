window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;
var canvasVisCtx=canvasVis.getContext("2d"),context=new (window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext),analyser=context.createAnalyser();analyser.fftSize=256;analyser.smoothingTimeConstant=.7;analyser.minDecibels=-160;analyser.maxDecibels=-35;
function freqAnalyser(){var a,b,c=new Uint8Array(92);a=canvasVisCtx.createLinearGradient(0,canvasVis.height,0,0);var d=Math.floor(c.length/92);window.requestAnimationFrame(freqAnalyser);analyser.getByteFrequencyData(c);analyser||canvasVis.html(c[0]);canvasVisCtx.clearRect(0,0,canvasVis.width,canvasVis.height);a.addColorStop(.98,"#FFCB05");a.addColorStop(.3,"#00aeef");a.addColorStop(.1,"#FFCB05");canvasVisCtx.fillStyle=a;for(i=0;92>i;i+=1){for(j=a=0;j<d;j+=1)a+=c[i*d+j];b=a/d;a=canvasVis.width/92;
b=b/256*canvasVis.height;canvasVisCtx.fillRect(i*a,canvasVis.height,a/1.2,-b)}}var source1=context.createMediaElementSource(audioE);source1.connect(analyser);analyser.connect(context.destination);freqAnalyser();resizeCanvas=function(){canvasVis.width=window.innerWidth;canvasVis.height=window.innerHeight};window.addEventListener("resize",resizeCanvas,!1);resizeCanvas();
